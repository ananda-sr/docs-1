

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QuickStart Guide &mdash; FlexSwitch 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="FlexSwitch 1.0 documentation" href="index.html"/>
        <link rel="next" title="Getting started with flexswitch on Docker" href="dockerIntro.html"/>
        <link rel="prev" title="Welcome to FlexSwitch" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> FlexSwitch
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dockerIntro.html"> Docker Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="vagrantIntro.html"> Vagrant Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ONIE_install.html"> Hardware Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use-it">How to use it?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#utilizing-the-rest-api">Utilizing the Rest API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utilizing-the-python-sdk">Utilizing the Python SDK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-via-json-file">Configuration via JSON File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ansible-integration">Ansible Integration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer.html"> Developer Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="nwengineer.html"> Network Engineer Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html"> Example Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="softwareflexswitch.html"> Software Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ONIE_install.html"> ONIE Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="apis.html">API reference!</a></li>
<li class="toctree-l1"><a class="reference internal" href="apis.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">FlexSwitch</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>QuickStart Guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/quickstart.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quickstart-guide">
<h1>QuickStart Guide<a class="headerlink" href="#quickstart-guide" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dockerIntro.html"> Docker Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="vagrantIntro.html"> Vagrant Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ONIE_install.html"> Hardware Tutorial</a></li>
</ul>
</div>
<div class="section" id="how-to-use-it">
<h2>How to use it?<a class="headerlink" href="#how-to-use-it" title="Permalink to this headline">¶</a></h2>
<p>FlexSwitch comes supplied with a configuration manager which supplies the FrontEnd to our system and acts as a light-weight director of RESTful API calls.  This is the portion of the system, that will direct a configuration item to the appropriate daemon or database call.  In order to simplify how these calls are segmented for the user, the API calls are organized into two categories. +State+ and +Config+ operations.  Every object in the system has both a State and Config operation that can be performed against it.</p>
<p>On the Config portion, this means when you supply the data you want in JSON format and sent to the associated API to have the configuration applied.  These operations can be done in 3 ways:</p>
<blockquote>
<div><ul>
<li><p class="first">Directly calling the RestFul API</p>
</li>
<li><p class="first">Utilizing the supplied Python SDK</p>
</li>
<li><dl class="first docutils">
<dt>Pushing configuration via JSON formatted file</dt>
<dd><ul class="first last simple">
<li>File can be managed via Anisble, Puppet, Chef, etc.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Familiar, industry standard CLI</p>
</li>
</ul>
</div></blockquote>
<div class="section" id="utilizing-the-rest-api">
<h3>Utilizing the Rest API<a class="headerlink" href="#utilizing-the-rest-api" title="Permalink to this headline">¶</a></h3>
<p>FlexSwitch comes with a RestFul API that can be used for configuration, state querying and troubleshooting of our protocols and system daemons.  Below is a primer on how to interact with this system, utilizing the RestFul API to adjust the ARP global timeout value.</p>
<p>In order to perform this operation with the Restful API, you would create the correctly structured JSON and send to the ArpConfig REST API:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@5b5a8d783113</span><span class="p">:</span><span class="o">/</span><span class="c1"># curl -X POST --header &#39;Content-Type: application/json&#39; --header &#39;Accept: application/json&#39; -d &#39;{&quot;ArpConfigKey&quot;:&quot;1&quot;, &quot;Timeout&quot;:1000}&#39; http://localhost:8080/public/v1/config/ArpConfig</span>
<span class="p">{</span><span class="s2">&quot;ObjectId&quot;</span><span class="p">:</span><span class="s2">&quot;a97b920d-8b10-47b1-7ea9-890b07f6e712&quot;</span><span class="p">,</span><span class="s2">&quot;Error&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>As you can see This is a 1:1 mapping of config to a specifc Object, in this case Timeout value of 1000 to ARP.</p>
<p>On the State side, this is more invovled, since you can have multiple items, that could potentially have thousand of different states.  Think the prefixes/next-hop entries` in the routing table or multiple IP/MAC mappings with an ARP table.  Due to this variance in data supplied, State operations are broken down into GetBulk, which supplies information from the entire object OR just an indiviual Get, which returns, just the parameters requested from an object.  The way in which these calls are made is based on the pluralization of the object itself.</p>
<p>Lets use ARP again as an example.  If you wished to grab all entry&#8217;s from the ARP table, you would query the &#8220;+ArpEntry+&#8221; state object. However, in order to dictate you wanted all entires, rather than a specific value, you would add a trailing &#8220;+s+&#8221; to make the operation plural, resulting in a call of &#8220;+ArpEntrys+&#8221;, see below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@5c3bca6fb77e</span><span class="p">:</span><span class="o">/</span><span class="c1"># curl -X GET --header &#39;Content-Type: application/json&#39; &#39;http://localhost:8080/public/v1/state/ArpEntrys&#39; | python -m json.tool</span>
  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>   <span class="mi">213</span>  <span class="mi">100</span>   <span class="mi">213</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">44654</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mi">53250</span>
<span class="p">{</span>
    <span class="s2">&quot;CurrentMarker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MoreExist&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;NextMarker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;ObjCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;Object&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ExpiryTimeLeft&quot;</span><span class="p">:</span> <span class="s2">&quot;9m57.74904463s&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Intf&quot;</span><span class="p">:</span> <span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;IpAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;51.1.1.5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;MacAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;4e:8c:3d:c8:d4:09&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Vlan&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;ObjectId&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you attempted to make such a call to just &#8220;+ArpEntry+&#8221;, you would be returned an error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@5c3bca6fb77e</span><span class="p">:</span><span class="o">/</span><span class="c1"># curl  -H &quot;Accept: application/json&quot; &quot;http://localhost:8080/public/v1/state/ArpEntry&quot; | python -m json.tool</span>
  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>   <span class="mi">119</span>  <span class="mi">100</span>   <span class="mi">119</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">21715</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mi">23800</span>
<span class="p">{</span>
    <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to find entry. Internal error processing GetArpEntryState: Unable to find Arp entry for given IP: </span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is due to the fact, that configruation manager expected JSON data to be supplied requesting a specific parameter to search the ARP table on.</p>
<p>In order to sucessfully, complete the &#8220;+ArpEntry+&#8221; query, we will supply JSON data for IP address 51.1.1.5:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@5c3bca6fb77e</span><span class="p">:</span><span class="o">/</span><span class="c1"># curl -X GET --header &#39;Content-Type: application/json&#39; -d &#39;{&quot;IpAddr&quot;:&quot;51.1.1.5&quot;}&#39; &#39;http://localhost:8080/public/v1/state/ArpEntry&#39; | python -m json.tool</span>
  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>   <span class="mi">157</span>  <span class="mi">100</span>   <span class="mi">136</span>  <span class="mi">100</span>    <span class="mi">21</span>  <span class="mi">25185</span>   <span class="mi">3888</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mi">27200</span>
<span class="p">{</span>
    <span class="s2">&quot;Object&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ExpiryTimeLeft&quot;</span><span class="p">:</span> <span class="s2">&quot;9m56.277773536s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intf&quot;</span><span class="p">:</span> <span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IpAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;51.1.1.5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MacAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;4e:8c:3d:c8:d4:09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Vlan&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;ObjectId&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The call now returns sucessfully with the requested data.  Also note, that returned data is no longer wrapped in GetBulk &#8220;+Objects+&#8221; header; I.E. the following is missing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;CurrentMarker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;MoreExist&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
<span class="s2">&quot;NextMarker&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;ObjCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[{}]</span>
</pre></div>
</div>
<p>This is due to the fact, that only a single object of data was targeted, rather than a bulk operation. The extra object data is not required for a GetBulk operation.</p>
</div>
<div class="section" id="utilizing-the-python-sdk">
<h3>Utilizing the Python SDK<a class="headerlink" href="#utilizing-the-python-sdk" title="Permalink to this headline">¶</a></h3>
<p>FlexSwitch comes with a Python SDK that can be utilized for configuration, state querying and troubleshooting of our protocols and system daemons.  This module can be imported to a python script you have written to deploy the system or grab state on a periodic basis.
Below is a primer on how to interact with this system, utilizing the Python SDK to adjust the ARP global timeout value.</p>
<p>In order to perform this operation with the Python SDK API, you would utilize the following python methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;from flexswitchV2 import FlexSwitch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FlexSwitch</span><span class="p">(</span><span class="s2">&quot;10.1.10.243&quot;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span><span class="o">.</span><span class="n">createArpConfig</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="go">({u&#39;ObjectId&#39;: u&#39;45dff5a0-7dc1-441d-723d-ccf731186ece&#39;, u&#39;Error&#39;: u&#39;&#39;}, None)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the ObjectID and UUID are the same.</p>
</div>
<p>As you can see This is a 1:1 mapping of config to a specifc Object, in this case Timeout value of 1000 to ARP.</p>
<p>On the State side, this is more invovled, since you can have multiple items, that could potentially have thousand of different states.  Think the prefixes/next-hop entries in the routing table or multiple IP/MAC mappings with an ARP table.  Due to this variance in data supplied, State operations are broken down into GetBulk, which supplies information from the entire object OR just an indiviual Get, which returns, just the parameters requested from an object.  The way in which these calls are made is performed by utilizing the method with &#8220;+getAll+&#8221; followed by the Object you wanted to grab; I.E. Arp, Bfd, BGP, etc.</p>
<p>Lets use ARP again as an example.  If you wished to grab all state entry&#8217;s from the ARP table, you would utilize the &#8220;+getAllArpEntryStates()+&#8221; method. With all Python SDK methods, see below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flexswitchV2</span> <span class="k">import</span> <span class="n">FlexSwitch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FlexSwitch</span><span class="p">(</span><span class="s2">&quot;10.1.10.243&quot;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span><span class="o">.</span><span class="n">getAllArpEntryStates</span><span class="p">()</span>
<span class="go">[{u&#39;Object&#39;: {u&#39;ConfigObj&#39;: None, u&#39;Intf&#39;: u&#39;fpPort47&#39;, u&#39;Vlan&#39;: u&#39;Internal Vlan&#39;, u&#39;IpAddr&#39;: u&#39;172.16.0.14&#39;, u&#39;ExpiryTimeLeft&#39;: u&#39;9m24.869691096s&#39;, u&#39;MacAddr&#39;: u&#39;a8:9d:21:aa:8e:01&#39;}, u&#39;ObjectId&#39;: u&#39;&#39;}, {u&#39;Object&#39;: {u&#39;ConfigObj&#39;: None, u&#39;Intf&#39;: u&#39;fpPort49&#39;, u&#39;Vlan&#39;: u&#39;Internal Vlan&#39;, u&#39;IpAddr&#39;: u&#39;172.16.0.20&#39;, u&#39;ExpiryTimeLeft&#39;: u&#39;9m43.991376701s&#39;, u&#39;MacAddr&#39;: u&#39;00:02:03:04:05:00&#39;}, u&#39;ObjectId&#39;: u&#39;&#39;}]</span>
</pre></div>
</div>
<p>If you wanted to make  a call to just grab a specific Arp Entry from the state table, you would utilize method, getArpEntryStates(), see below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flexswitchV2</span> <span class="k">import</span> <span class="n">FlexSwitch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FlexSwitch</span><span class="p">(</span><span class="s2">&quot;10.1.10.243&quot;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span><span class="o">.</span><span class="n">getArpEntryState</span><span class="p">(</span><span class="s2">&quot;172.16.0.20&quot;</span><span class="p">)</span>
<span class="go">({u&#39;Object&#39;: {u&#39;ConfigObj&#39;: None, u&#39;Intf&#39;: u&#39;fpPort49&#39;, u&#39;Vlan&#39;: u&#39;Internal Vlan&#39;, u&#39;IpAddr&#39;: u&#39;172.16.0.20&#39;, u&#39;ExpiryTimeLeft&#39;: u&#39;16m38.505153914s&#39;, u&#39;MacAddr&#39;: u&#39;00:02:03:04:05:00&#39;}, u&#39;ObjectId&#39;: u&#39;&#39;}, None)</span>
</pre></div>
</div>
<p>The call now returns sucessfully with only the requested data.</p>
<div class="section" id="configuration-via-json-file">
<h4>Configuration via JSON File<a class="headerlink" href="#configuration-via-json-file" title="Permalink to this headline">¶</a></h4>
<p>In addition to configuring FlexSwitch via API calls or the Python SDK – it is also possible to supply a configuration file formatted in JSON.</p>
<p>For example, this JSON file will configure these parameters from the previous examples:</p>
<dl class="docutils">
<dt>3 Vlans are created:</dt>
<dd><ul class="first last simple">
<li>Vlan 100, ports 1-10 with IP address 10.10.100.1/24</li>
<li>Vlan 200, ports 11,12 with IP address 10.10.101.1/24</li>
<li>Vlan 300, ports 13-15, and 17 with IP address 10.10.102.1/24</li>
<li>Speed is set to 1G for port 1</li>
</ul>
</dd>
</dl>
<p>Example desiredConfig.json:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="s2">&quot;Vlan&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                        <span class="s2">&quot;UntagIntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;1-10&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;VlanId&quot;</span><span class="p">:</span> <span class="mi">100</span>
                <span class="p">},</span>
                <span class="p">{</span>
                        <span class="s2">&quot;UntagIntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;11,12&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;VlanId&quot;</span><span class="p">:</span> <span class="mi">200</span>
                <span class="p">},</span>
                <span class="p">{</span>
                        <span class="s2">&quot;UntagIntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;13-15,17&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IntfList&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;VlanId&quot;</span><span class="p">:</span> <span class="mi">300</span>
                <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;IPv4Intf&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                        <span class="s2">&quot;IntfRef&quot;</span><span class="p">:</span> <span class="s2">&quot;vlan100&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IpAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;10.10.100.1/24&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                        <span class="s2">&quot;IntfRef&quot;</span><span class="p">:</span> <span class="s2">&quot;vlan200&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IpAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;10.10.101.1/24&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                        <span class="s2">&quot;IntfRef&quot;</span><span class="p">:</span> <span class="s2">&quot;vlan300&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;IpAddr&quot;</span><span class="p">:</span> <span class="s2">&quot;10.10.102.1/24&quot;</span>
                <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;Port&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                        <span class="s2">&quot;PortNum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;Speed&quot;</span><span class="p">:</span> <span class="mi">1000</span>
                <span class="p">}</span>
        <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>This JSON file is declarative and not order-dependent – all configurations are ingested at once and executed in the order required.</p>
<p>Configuration files are parsed and executed using the “monitor.py” python app:</p>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>Add JSON configuration to desiredConfig.json (creating the file, if necessary):</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>$ vi /opt/flexswitch/desiredConfig.json
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Apply the configuration using monitor.py in the /opt/flexswitch/apps/cfgmon directory:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>$ cd /opt/flexswitch/apps/cfgmon

$ python monitor.py --applyConfig=True

Namespace(applyConfig=True, cfgDir=&#39;/opt/flexswitch/&#39;, ip=&#39;localhost&#39;, poll=None, port=&#39;8080&#39;, saveConfig=True)
System Is ready
Configuration is saved to /opt/flexswitch//runningConfig.json
Updating object Port
Creating Object Vlan
Creating Object Vlan
Creating Object Vlan
Creating Object IPv4Intf
Creating Object IPv4Intf
Creating Object IPv4Intf
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>Now that the configuration is applied, the operational state can be verified:</p>
<p><a class="reference external" href="http://10.1.10.43:8080/public/v1/state/IPv4Intfs">http://10.1.10.43:8080/public/v1/state/IPv4Intfs</a></p>
<img alt="_images/python_IPv4Intfs_config.png" src="_images/python_IPv4Intfs_config.png" />
</div>
<div class="section" id="ansible-integration">
<h4>Ansible Integration<a class="headerlink" href="#ansible-integration" title="Permalink to this headline">¶</a></h4>
<p>Utilizing the JSON file method, it is possible to utilize automation tools like Ansible to manage FlexSwitch configurations.</p>
<p>Prerequisites:
Prior to utilizing Ansible to manage FlexSwitch, a working Ansible environment needs to be built.</p>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>Follow the Operating System appropriate instructions to install Ansible on the desired host:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>http://docs.ansible.com/ansible/intro_installation.html

For the purposes of this guide, these steps were performed on an Ubuntu Server running 14.04:

$ sudo apt-get install software-properties-common
$ sudo apt-add-repository ppa:ansible/ansible
$ sudo apt-get update
$ sudo apt-get install ansible
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Generate an SSH key for Ansible to use for managing devices:</dt>
<dd><dl class="first last docutils">
<dt>::</dt>
<dd><p class="first">$ ssh-keygen</p>
<p class="last">For the purposes of this guide a passphrase is not used and the key is stored in the default location: /home/ansible/.ssh/id_rsa.pub.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>This generated SSH key needs to be added to the root user of the device, enabling SSH management by Ansible:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>On the device to be managed by Ansible:

$ sudo mkdir -p /root/.ssh/
$ sudo vi /root/.ssh/authorized_keys

Add the contents of id_rsa.pub from the user on the device running Ansible to this authorized_keys file.  The id_rsa.pub contents should be one line and follow this format:

ssh-rsa &lt;snip&gt; ansible@ansible-server.snaproute.com
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Add target host to /etc/ansible/hosts:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>$ sudo vi /etc/ansible/hosts

Add hosts as either IP or resolvable hostname, one on each line.  The /etc/ansible/hosts inventory file can be simply a list of hosts or it can be more complex and define groups – as outlined in the example.

For this example, here is the contents of the Ansible inventory file:

$ cat /etc/ansible/hosts
10.1.10.43
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>The ssh key can be tested by issuing a “ping” from Ansible:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span>$ ansible -u root -m ping all

10.1.10.43 | SUCCESS =&gt; {
        &quot;changed&quot;: false,
        &quot;ping&quot;: &quot;pong&quot;
}

The above shows a successful ping response using the remote user of root, as that is the user that houses the SSH key on the target system.
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dockerIntro.html" class="btn btn-neutral float-right" title="Getting started with flexswitch on Docker" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to FlexSwitch" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Snaproute.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>